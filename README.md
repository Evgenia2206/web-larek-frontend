# Проектная работа "Веб-ларек"

https://github.com/Evgenia2206/web-larek-frontend.git

## Описание
Приложение представляет собой интернет-магазин с товарами для веб-разработчиков — Web-ларёк. В нём можно посмотреть каталог товаров, добавить товары в корзину и сделать заказ.

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Документация  

### Описание данных  
Карточка товара  
```  
interface IProduct {
	id: string;
    title: string;
    category: string;
    description: string;
    image: string;
    price: number | null;
}
```  
Корзина  
```  
interface IBasket {
    basketProducts: IProduct[];
    productsCost: number;
}
```  
Заказ  
```  
interface IOrder {
    order: IBasket;
    payment: string;
    address: string;
	email: string; 
	phone: string; 
}
```  

### Архитектура  
Используется паттерн проектирования MVP (Model-View-Presenter), согласно которому код приложения разбивается на три слоя:  
1. Слой данных (Model) предоставляет данные для пользовательского интерфейса.  
2. Слой отображения (View) реализует отображение данных и маршрутизацию пользовательских команд или событий презентеру.  
3. Презентер (Presenter) управляет данными и отображением.  

#### Базовый код  
КЛАСС Api  
Отвечает за отправку базовых запросов серверу и обработку полученных ответов. Данный класс включает в себя следующие методы: get и post для отправки запросов на сервер, handleResponse для обработки ответа сервера.  

КЛАСС EventEmitter  
Брокер событий, устанавливает и снимает слушателей событий, вызывает слушателей при возникновении события. Данный класс включает в себя следующие методы: on/off для подписки/отписки, emit для уведомления подписчиков о наступлении события, onAll/onOff для для подписки/отписки для всех событий, trigger для отложенной генерации события.  

КЛАСС Component  
Представляет собой абстрактный класс, который наследуется всеми компонентами интерфейса. Он предоставляет собой общие методы для управления DOM-элементами, такие как переключение классов, установка текстового содержимого компонента или его изображения, управление видимостью и другие. Конструктор этого класса принимает HTMLElement. Данный класс включает в себя методы:  
* toggleClass() - для переключения класса DOM-элемента;  
* setText() - для установки текстового содержимого DOM-элемента;  
* setDisabled() - для смены статуса блокировки DOM-элемента;  
* setHidden() - для скрытия DOM-элемента;  
* setVisible() - для показа DOM-элемента;  
* setImage() - для установки изображения с альтернативным текстом;  
* render() - для отрисовки DOM-элемента.  

#### Слой данных  
КЛАСС ProductData  
Отвечает за хранение данных карточек товаров и работу с ними. Конструктор этого класса принимает инстанс класса EventEmitter. Поля класса хранят следующие данные:  
* products: IProduct[] - массив карточек товаров;  
* events: IEvents - инстанс класса EventEmitter для инициирования событий при изменении данных.  
Данный класс включает в себя метод getProduct(id: string): IProduct, который возвращает карточку товара по ее id; геттеры и сеттеры для получения и записи данных полей класса.  

КЛАСС BasketData  
Отвечает за хранение данных корзины и работу с ней. Конструктор этого класса принимает инстанс класса EventEmitter. Поля класса хранят следующие данные:  
* basketProducts: IProduct[] - массив карточек товаров, добавленных в корзину;  
* events: IEvents - инстанс класса EventEmitter для инициирования событий при изменении данных.  
Данный класс включает в себя геттеры get products() для получения текущего списка карточек товаров в корзине, get productsCost() для получения общей стоимости товаров в корзине, методы addToBasket() для добавления товара в корзину, removeFromBasket() для удаления товаров из корзины, getProductsCost() для расчета и получения общей стоимости товаров в корзине, processBasketToOrder() для отправки данных из корзины в заказ, clearBasket() для очистки корзины, getButtonState() для изменения кнопки карточки товара в зависимости от наличия товара в корзине.  

КЛАСС OrderData  
Отвечает за хранение данных заказа и работу с ним. Конструктор этого класса принимает инстанс класса EventEmitter. Поля класса хранят следующие данные:  
* order: IBasket - данные о составе и стоимости заказа, поступающие из корзины;  
* formErrors: TFormErrors - ошибки валидации формы заказа;  
* способ оплаты и контактные данные покупателя, заполняемые пользователем.  

#### Слой отображения  
КЛАСС MainPageUI  
Наследуется от класса Component и отвечает за отображение главной страницы приложения, включая список карточек товаров и значок корзины с указанием количества товаров в ней. Конструктор этого класса принимает HTMLElement, в котором будет размещен список карточек товаров, а также инстанс класса EventEmitter для инициирования событий при изменении данных. Поля класса хранят следующие данные:  
* wrapper: HTMLElement - обертка страницы;  
* catalogue: HTMLElement - отображение карточек товаров на странице;  
* basket: HTMLElement - отображение корзины;  
* counter: HTMLElement - отображение количества товара, добавленного в корзину.  
Данный класс включает в себя сеттеры set catalogue() для вывода списка карточек товаров, set locked() для блокировки взаимодействия с текущей страницей, set counter() для установки значения количества товара в корзине.  

КЛАСС ModalUI  
Наследуется от класса Component и отвечает за отображение модальных окон, устанавливает слушатели для закрытия модального окна по клику вне модального окна и по клику на иконку «Закрыть» (крестик). Конструктор этого класса принимает HTMLElement (элемент модального окна в DOM) и инстанс класса EventEmitter для инициирования событий при изменении данных. Поля класса хранят следующие данные:  
* content: HTMLElement - содержимое модального окна;  
* closeButton: HTMLButtonElement - кнопка закрытия модального окна.  
Данный класс включает в себя методы open(), close(), render() для открытия, закрытия и отображения содержимого модальных окон, а также сеттер для установки содержимого модального окна.  

КЛАСС CardUI  
Наследуется от класса Component и отвечает за отображение карточек товаров в разных частях интерфейса, устанавливает слушатель для добавления карточки товара в корзину по клику на соответствующу кнопку. Конструктор этого класса принимает HTMLElement (для добавления карточки товара в DOM) и инстанс класса EventEmitter для инициирования событий при изменении данных. Поля класса хранят следующие данные:  
* id: HTMLElement - идентификатор карточки товара;
* title: HTMLElement - название;
* category: HTMLElement - категория;
* description: HTMLElement - описание;
* image: HTMLImageElement - изображение;
* price: HTMLElement - цена;
* button: HTMLButtonElement - кнопка добавления в корзину.  
Данный класс включает в себя геттеры и сеттеры для получения и записи данных полей класса.  

КЛАСС BasketUI  
Наследуется от класса Component и отвечает за отображение текущего состояния корзины покупок, устанавливает слушатели для обработки действий пользователя. Конструктор этого класса принимает HTMLElement и инстанс класса EventEmitter для инициирования событий при изменении данных. Поля класса хранят следующие данные:  
* products: HTMLElement[] - отображение добавленных в корзину товаров;  
* total: HTMLElement - отображение общей стоимости товаров в корзине;  
* button: HTMLButtonElement - кнопка открытия формы оформления заказа.  
Данный класс включает в себя метод updateButtonState() для изменения состояния кнопки оформления заказа в зависимости от общей стоимости товаров в корзине, а также сеттеры set items() и set total() для обновления списка товаров и их общей стоимости соответственно.  

КЛАСС FormUI  
Наследуется от класса Component и отвечает за отображение форм в приложении. Конструктор этого класса принимает HTMLElement и инстанс класса EventEmitter для инициирования событий при изменении данных. Поля класса хранят следующие данные:  
* submitButton: HTMLButtonElement - кнопка отправки формы;  
* errors: HTMLElement - вывод ошибок валидации.  
Данный класс включает в себя следующие методы: onInputChange() для изменения значения любого поля ввода в форме, render() для отображения формы, а также сеттеры set valid() для установки валидности формы и set errors() для установки ошибок валидации.

КЛАСС OrderDeliveryUI  
Наследуется от класса FormUI и отвечает за отображение формы оформления заказа с информацией о способе оплаты и адресе доставки, а также валидацию введенных данных. Конструктор этого класса принимает HTMLElement и инстанс класса EventEmitter для инициирования событий при изменении данных. Поля класса хранят следующие данные:  
* cardBtn: HTMLButtonElement - кнопка выбора платы онлайн;  
* cashBtn: HTMLButtonElement - кнопка выбора наличной оплаты;  
* address: HTMLInputElement - адрес доставки.   
Данный класс включает в себя сеттер для добавления адреса доставки и методы togglePayment() для переключения способа оплаты, resetPayment() для сброса состояния кнопок оплаты.  

КЛАСС OrderContactsUI  
Наследуется от класса FormUI и отвечает за отображение формы оформления заказа с информацией об адресе электронной почты и номере телефона заказчика, а также валидацию введенных данных. Конструктор этого класса принимает HTMLElement и инстанс класса EventEmitter для инициирования событий при изменении данных. Поля класса хранят следующие данные:  
* email: HTMLInputElement - адрес электронной почты;  
* phone: HTMLInputElement - номер телефона.   
Данный класс включает в себя сеттеры для добавления адреса электронной почты и номера телефона. 

КЛАСС OrderProcessedUI  
Наследуется от класса Component и отвечает за отображение формы подтверждения оформления заказа. Конструктор этого класса принимает HTMLElement и инстанс класса EventEmitter для инициирования событий при изменении данных. Поля класса хранят следующие данные:  
* totalOrder: HTMLElement - уведомление о стоимость заказа;  
* continueButton: HTMLButtonElement - кнопка продолжения работы с приложением.  
Данный класс включает в себя сеттер set total() для обновления стоимости оформленного заказа.  

#### Презентер  
Описывает взаимодействие между слоем данных и слоем отображения, находится в файле index.ts. Взаимодействие осуществляется за счет событий, генерируемых с помощью брокера событий и обработчиков событий, описанных в указанном файле, где сначала создаются экземпляры всех необходимых классов, а затем настраивается обработка событий.  

События, генерируемые изменением данных:  
* products:change - изменение списка карточек товаров, отображаемых на главной странице;  
* basketProducts:change - изменение списка карточек товаров, добавленных в корзину;  
* order:change - изменение данных заказа.  

События, генерируемые компонентами отображения:  
* card:select - выбор карточки товара для дальнейшей работы;  
* card:choose - добавление карточки товара в корзину;  
* card:cancel - удаление карточки товара из корзины;  
* modal:open - открытие модального окна;  
* modal:close - закрытие модального окна;  
* basket:count - изменение отображения на главной странице количества товаров, добавленных в корзину;  
* basket:open - открытие окна корзины;  
* order:open - открытие окна заказа;  
* order:input - ввод данных в форме заказа;  
* order:change - изменение полей формы заказа;  
* order:validate - проверка правильности заполнения данных в форме заказа;  
* order:process - успешное завершение оформления заказа.